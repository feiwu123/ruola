webpackJsonp([4],{"16es":function(e,t){},"2vWp":function(e,t,a){"use strict";(function(e){var t=a("pFYg"),r=a.n(t);!function(e){function t(t,a,r){for(var s=e(t),i=s.clone(a,r),n=s.find("textarea").add(s.filter("textarea")),o=i.find("textarea").add(i.filter("textarea")),l=s.find("select").add(s.filter("select")),c=i.find("select").add(i.filter("select")),u=0,p=n.length;u<p;++u)e(o[u]).val(e(n[u]).val());for(u=0,p=l.length;u<p;++u)for(var d=0,_=l[u].options.length;d<_;++d)!0===l[u].options[d].selected&&(c[u].options[d].selected=!0);return i}function a(a){var r=e("");try{r=t(a)}catch(t){r=e("<span />").html(a)}return r}function s(t,a,r){var s=e.Deferred();try{var i=(t=t.contentWindow||t.contentDocument||t).document||t.contentDocument||t;r.doctype&&i.write(r.doctype),i.write(a),i.close();var n=!1,o=function(){if(!n){t.focus();try{t.document.execCommand("print",!1,null)||t.print(),e("body").focus()}catch(e){t.print()}t.close(),n=!0,s.resolve()}};e(t).on("load",o),setTimeout(o,r.timeout)}catch(e){s.reject(e)}return s}function i(e,t){return s(window.open(),e,t).always(function(){try{t.deferred.resolve()}catch(e){console.warn("Error notifying deferred",e)}})}function n(e){return!!("object"==("undefined"==typeof Node?"undefined":r()(Node))?e instanceof Node:e&&"object"==(void 0===e?"undefined":r()(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName)}e.print=e.fn.print=function(){var r,o,l=this;l instanceof e&&(l=l.get(0)),n(l)?(o=e(l),arguments.length>0&&(r=arguments[0])):arguments.length>0?n((o=e(arguments[0]))[0])?arguments.length>1&&(r=arguments[1]):(r=arguments[0],o=e("html")):o=e("html");var c={globalStyles:!0,mediaPrint:!1,stylesheet:null,noPrintSelector:".no-print",iframe:!0,append:null,prepend:null,manuallyCopyFormValues:!0,deferred:e.Deferred(),timeout:750,title:null,doctype:"<!doctype html>"};r=e.extend({},c,r||{});var u=e("");r.globalStyles?u=e("style, link, meta, base, title"):r.mediaPrint&&(u=e("link[media=print]")),r.stylesheet&&(u=e.merge(u,e('<link rel="stylesheet" href="'+r.stylesheet+'">')));var p=t(o);if((p=e("<span/>").append(p)).find(r.noPrintSelector).remove(),p.append(t(u)),r.title){var d=e("title",p);0===d.length&&(d=e("<title />"),p.append(d)),d.text(r.title)}p.append(a(r.append)),p.prepend(a(r.prepend)),r.manuallyCopyFormValues&&(p.find("input").each(function(){var t=e(this);t.is("[type='radio']")||t.is("[type='checkbox']")?t.prop("checked")&&t.attr("checked","checked"):t.attr("value",t.val())}),p.find("select").each(function(){e(this).find(":selected").attr("selected","selected")}),p.find("textarea").each(function(){var t=e(this);t.text(t.val())}));var _,h,f,v,g=p.html();try{r.deferred.notify("generated_markup",g,p)}catch(e){console.warn("Error notifying deferred",e)}if(p.remove(),r.iframe)try{_=g,f=e((h=r).iframe+""),0===(v=f.length)&&(f=e('<iframe height="0" width="0" border="0" wmode="Opaque"/>').prependTo("body").css({position:"absolute",top:-999,left:-999})),s(f.get(0),_,h).done(function(){setTimeout(function(){0===v&&f.remove()},1e3)}).fail(function(e){console.error("Failed to print from iframe",e),i(_,h)}).always(function(){try{h.deferred.resolve()}catch(e){console.warn("Error notifying deferred",e)}})}catch(e){console.error("Failed to print from iframe",e.stack,e.message),i(g,r)}else i(g,r);return this}}(e)}).call(t,a("7t+N"))},JyVJ:function(e,t){},Znun:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),s=a.n(r),i=a("mvHQ"),n=a.n(i),o=a("0881"),l=a("GxbW"),c=a("2CU/"),u=a("uXZL"),p=a.n(u),d=a("t4zo"),_=a.n(d),h=(a("2vWp"),a("PJh5"),{name:"UploadMag",data:function(){return{CONST:o.a,HOST:o.a.HOST,Rsa:c.a.encryptRsa,loading:!1,customer_data:[],table:{prop:"default",order:"ascending",page_size:5,current_page:1},Files:[],user_select:{loading:!1,select:[],value:""},operation_customer:{},regexp_ipt:"",array_ipt:"",edit_rule:!1,upload_loading:!1,RuleImg:"png",label_for_img_select:"Select Folder",Orders:{data:[],prop:"time",order:"ascending",page_size:5,current_page:1,loading:!1,total:0},FileDefaultName:"excel.xlsx",fullscreenLoading:!1,excel_param:{id:"",key:"",price:"",_describe:"",date:""},excelData:[],excelTitle:[],excelDataNoChange:[],order_table_width:void 0,img_progress:0,img_progress_show:!1,isProduction:!1,download_excel_loading:!1,dialog_for_up_result:!1,up_result_data:[],dialog_for_up_result_up_once:!1,show_result_row:{},single_up_wc:{id:"",no:"",method:"",weight:"",countrycode:"",province:"",city:"",name:"",postcode:"",street:"",telephone:"",enname:"",cnname:"",content:""},create_barcode_show:!1,create_barcode_loading:!1,create_qrcode_loading:!1}},methods:{requestData:function(){var e=this;this.loading=!0;var t=this.$store.state.user.key;l.a.cRequest(this,"/customer/bind/list",{key:t},function(t){switch(t.service_code){case o.a.CUSTOMER_BIND_LIST:e.customer_data=t.result;break;default:e.customer_data=[],l.a.showTip(e,"warning","UNKNOW ERROR!")}})},uploadFiles:function(){var e=this;if(this.regexp_ipt&&this.array_ipt){var t=new FormData;t.append("key",c.a.encryptRsa(this.$store.state.user.key)),t.append("id",c.a.encryptRsa(this.operation_customer.id)),t.append("_regexp",c.a.encryptRsa(this.regexp_ipt)),t.append("array",c.a.encryptRsa(this.array_ipt));for(var a=0;a<this.Files.length;a++)t.append("file",this.Files[a]);this.img_progress_show=!0,this.$http.post(this.HOST+"/order/upload/imgs",t,{uploadProgress:function(t){if(t.lengthComputable){var a=Math.floor(t.loaded/t.total*100);e.img_progress=a,e.img_progress>=100&&(e.img_progress_show=!1)}}}).then(function(e){var t=this;e.json().then(function(e){t.result=e.info})},function(e){})}else this.showTip("CREATE RULE FIRST PLEASE!")},changeFile:function(e){this.Files=e.target.files,this.percentage=0},selectRemoteMethod:function(e){var t=this;if(""!=e){this.user_select.loading=!0;var a=this.$store.state.user.key;l.a.cRequest(this,"/customer/query",{query:e,key:a},function(e){switch(e.service_code){case o.a.CUSTOMER_QUERY:t.user_select.select=e.result;break;default:t.user_select.select=[],l.a.showTip(t,"warning","UNKNOW ERROR!")}t.user_select.loading=!1})}else this.user_select.select=[]},bindingCustomer:function(){var e=this,t=this.user_select.value,a=this.$store.state.user.key;l.a.cRequest(this,"/customer/bind",{key:a,c_id:t},function(t){switch(t.service_code){case o.a.CUSTOMER_BIND:e.requestData(),l.a.showTip(e,"success","BIND SUCCESSFULLY!");break;default:l.a.showTip(e,"warning","UNKNOW ERROR!")}})},unbindingCustomer:function(e){},showUpload:function(e){this.create_barcode_show=!1,this.operation_customer=this.customer_data[e],this.excel_param.id=c.a.encryptRsa(this.operation_customer.id),this.excel_param.key=c.a.encryptRsa(this.$store.state.user.key),this.getRule(),this.requestOrdersData()},updateRule:function(){var e=this,t=this.$store.state.user.key,a=this.regexp_ipt,r=this.array_ipt;if(a&&r){var s=this.operation_customer.id;l.a.cRequest(this,"/order/upload/rule/update",{key:t,regexp:a,array:r,id:s},function(t){switch(t.service_code){case o.a.ORDER_UPDATE_RULE:l.a.showTip(e,"success","UPDATE SUCCESSFULLY!");break;default:l.a.showTip(e,"warning","UNKNOW ERROR!")}})}else l.a.showTip(this,"warning","INPUT BOTH REGEXP AND ARRAY!")},showRule:function(){this.edit_rule||(this.edit_rule=!0)},getRule:function(){var e=this;this.upload_loading=!0;var t=this.$store.state.user.key,a=this.operation_customer.id;l.a.cRequest(this,"/order/upload/rule/get",{key:t,id:a},function(t){switch(t.service_code){case o.a.ORDER_GET_RULE:e.regexp_ipt=t.result[0]._regexp,e.array_ipt=t.result[0].array;break;default:l.a.showTip(e,"warning","RULE GET UNKNOW ERROR!")}e.upload_loading=!1})},surePaid:function(){},sortChange:function(e){var t=e.order,a=e.prop;this.Orders.prop=a,this.Orders.order=t,this.requestOrdersData()},sizeChange:function(e){this.Orders.page_size=e,this.requestOrdersData()},currentChange:function(e){this.Orders.current_page=e,this.requestOrdersData()},requestOrdersData:function(){var e=this;this.Orders.loading=!0;var t=this.Orders,a=t.current_page,r=t.order,s=t.page_size,i=t.prop,n=this.$store.state.user.key,c=this.operation_customer.id;l.a.cRequest(this,"/order/list",{current_page:a,order:r,page_size:s,prop:i,key:n,id:c},function(t){switch(t.service_code){case o.a.ORDER_LIST:e.Orders.data=t.result,e.Orders.total=t.result[0]?t.result[0].total:0;break;default:e.Orders.data=[],l.a.showTip(e,"warning","UNKNOW ERROR!")}e.Orders.loading=!1})},showTip:function(e,t){l.a.showTip(this,t,e)},handleRemove:function(e,t){},handlePreview:function(e){},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeUpload:function(e){console.log(this.excel_param.date),this.fullscreenLoading=!0},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")},onUploadSuccess:function(e,t,a){},importExcel:function(e,t){e?this.requestOrdersData():this.fullscreenLoading=!1},priceChange:function(){this.excel_param.price=(this.excel_param.price.replace(/[^0-9\.]/g,"").replace(/^\./,"0.").replace(/^([0-9]+\.[0-9]*)([0-9\.]*)/,"$1")/1).toFixed(2)},checkOrderDetial:function(e){this.isProduction=!1,this.getFile(e),this.create_barcode_show=!0},analyzeData:function(e){return e},dealFile:function(e,t){var a=e;for(var r in this.excelTitle=[],a)if(a.hasOwnProperty(r)){var s=a[r];s.Image=(o.a.UPLOADS_IMGS_HOSTS+this.operation_customer.id+"/"+this.getUrl(s.SKU)).toLowerCase()}for(var i in this.excelDataNoChange=JSON.parse(n()(a)),t&&(a=t(e)),a[0])a[0].hasOwnProperty(i)&&this.excelTitle.push(i);this.fullscreenLoading=!1,a.length<=0?this.showTip("NO DATA!","warning"):this.excelData=a},fixdata:function(e){for(var t="",a=0,r=10240;a<e.byteLength/r;++a)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*r,a*r+r)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*r)))},getFile:function(e,t){var a=this;this.operation_order=this.Orders.data[e],this.$http({method:"get",url:o.a.SOURCE_HOST+"/uploads/excels/"+this.Orders.data[e].excel_name,responseType:"arraybuffer"}).then(function(e){var r=new Blob([e.data],{type:""}),s=(URL.createObjectURL(r),new FileReader),i=a;s.onload=function(e){var a=e.target.result;i.rABS?i.wb=p.a.read(btoa(this.fixdata(a)),{type:"base64"}):i.wb=p.a.read(a,{type:"binary"});var r=p.a.utils.sheet_to_json(i.wb.Sheets[i.wb.SheetNames[0]]);i.dealFile(i.analyzeData(r),t)},a.rABS?s.readAsArrayBuffer(r):s.readAsBinaryString(r)}).catch(function(e){})},getUrl:function(e){return l.a.getUrlWidthRules(this.regexp_ipt,this.array_ipt,e)},createBarCode:function(){var e=this;this.create_barcode_loading=!0;for(var t=[],a=0;a<this.excelData.length;a++){var r=this.excelData[a];t.push("[SKU_"+r.SKU+"][NO_"+r.no+"]")}if(0==t.length)return this.create_barcode_loading=!1,void l.a.showTip(this,"warning","请确保excel中包含'no'及'SKU'列，即包裹号!");var i=n()(t),u=new FormData,p=this.$store.state.user.key;p=c.a.encryptRsa(p),i=c.a.encryptRsa(i),u.append("json",i),u.append("key",p),this.$http.post(o.a.HOST+"/order/mbarcode",u,s()({headers:{"Content-Type":"application/x-www-form-urlencoded"}},o.a.SESSION_CONFIG_CROS)).then(function(t){var a=l.a.decryptResponse(t);switch(e.create_barcode_loading=!1,a.service_code){case o.a.CREATE_BARCODE:l.a.showTip(e,"success","条码创建成功，可以下载发货表!");break;default:l.a.showTip(e,"warning","UNKNOW ERROR!")}}).catch(function(e){})},createQrCode:function(){var e=this;this.create_qrcode_loading=!0;for(var t=[],a=0;a<this.excelData.length;a++){var r=this.excelData[a];t.push(r.SKU)}if(0==t.length)return this.create_barcode_loading=!1,void l.a.showTip(this,"warning","请确保excel中包含'SKU'列!");var i=n()(t),u=new FormData,p=this.$store.state.user.key;p=c.a.encryptRsa(p),i=c.a.encryptRsa(i),u.append("json",i),u.append("key",p),this.$http.post(o.a.HOST+"/order/mqrcode",u,s()({headers:{"Content-Type":"application/x-www-form-urlencoded"}},o.a.SESSION_CONFIG_CROS)).then(function(t){var a=l.a.decryptResponse(t);switch(e.create_qrcode_loading=!1,a.service_code){case o.a.CREATE_QRCODE:l.a.showTip(e,"success","二维码创建成功!");break;default:l.a.showTip(e,"warning","UNKNOW ERROR!")}}).catch(function(e){})},imgError:function(e,t){this.excelData[t].Image=this.excelData[t].Image.replace(/\/[^\/\.]+\.(jpeg|png|jpg)$/,"/front.$1")},createProduction:function(e){this.create_barcode_show=!1,this.getFile(e,this.changeJson)},changeJson:function(e){this.isProduction=!0;for(var t=[],a=[],r=/[_|-|-]{1}([a-z23456]+)$/i,s=0,i=0;i<e.length;i++){var n=e[i],o=n.SKU;if(o&&(o=o.replace(/\s/g,"")),o)if(r.exec(o)){var l=o.replace(/\s/g,"").replace(r,""),c=n.Quantity?parseInt(n.Quantity):0;s+=c;var u=t.indexOf(l),p="";try{p=r.exec(o)[1].toLowerCase()}catch(e){continue}var d={xs:"xs",s:"s",m:"m",l:"l",xl:"xl",xxl:"2xl","2xl":"2xl",xxxl:"3xl","3xl":"3xl",xxxxl:"4xl","4xl":"4xl",xxxxxl:"5xl","5xl":"5xl",xxxxxxl:"6xl","6xl":"6xl",adult:"adult",youth:"youth","2t":"2t","3t":"3t","4t":"4t","5t":"5t",yxs:"yxs",ys:"ys",ym:"ym",yl:"yl",yxl:"yxl"};u>-1?a[u][d[p]]+=c:(t.push(l),a.push({code:l,Image:n.Image,other:0,xs:0,s:0,m:0,l:0,xl:0,"2xl":0,"3xl":0,"4xl":0,"5xl":0,"6xl":0,adult:0,youth:0,"2t":0,"3t":0,"4t":0,"5t":0,yxs:0,ys:0,ym:0,yl:0,yxl:0}),a[a.length-1][d[p]]+=c)}else o=o.replace(/\s/g,""),t.push("[error]"+o),a.push({code:"[error]"+o,Image:n.Image,other:n.Quantity,xs:0,s:0,m:0,l:0,xl:0,"2xl":0,"3xl":0,"4xl":0,"5xl":0,"6xl":0,adult:0,youth:0,"2t":0,"3t":0,"4t":0,"5t":0,yxs:0,ys:0,ym:0,yl:0,yxl:0})}return a.sort(function(e,t){return e.code>t.code?-1:1}),a[0]&&(a[0].total=s),a},downloadFile:function(){var e=p.a.utils.book_new(),t=p.a.utils.table_to_sheet(document.querySelector("#print .el-table__header")),a=p.a.utils.table_to_sheet(document.querySelector("#print .el-table__body-wrapper"));p.a.utils.book_append_sheet(e,t,"表头"),p.a.utils.book_append_sheet(e,a,"内容");var r=p.a.write(e,{bookType:"xlsx",bookSST:!1,type:"array"});_()(new Blob([r],{type:"application/octet-stream"}),"test.xlsx")},downloadNoSendingFile:function(){var e=p.a.utils.book_new(),t=[];for(var a in console.log(this.up_result_data),this.up_result_data)if(this.up_result_data.hasOwnProperty(a)){var r=this.up_result_data[a];r&&r.no&&0==r._print&&t.push({no:r.no,label:r.label,quantity:r.quantity,content:r.content,print:r._print})}var s=p.a.utils.json_to_sheet(t,{header:["no"]});p.a.utils.book_append_sheet(e,s,"缺货表");var i=p.a.write(e,{bookType:"xlsx",bookSST:!1,type:"array"});_()(new Blob([i],{type:"application/octet-stream"}),this.operation_customer.name+"缺货表.xlsx")},downloadSendingFile:function(){var e=p.a.utils.book_new(),t=[];for(var a in this.up_result_data)if(this.up_result_data.hasOwnProperty(a)){var r=this.up_result_data[a];r&&r.no&&r._print>0&&t.push({no:r.no})}var s=p.a.utils.json_to_sheet(t,{header:["no"]});p.a.utils.book_append_sheet(e,s,"发货表");var i=p.a.write(e,{bookType:"xlsx",bookSST:!1,type:"array"});_()(new Blob([i],{type:"application/octet-stream"}),this.operation_customer.name+"发货表.xlsx")},orderCode:function(){this.excelData.sort(function(e,t){return e.hasOwnProperty("code")?e.code.split("").reverse().join("")>t.code.split("").reverse().join("")?-1:1:e.hasOwnProperty("SKU")?e.SKU.split("").reverse().join("")>t.SKU.split("").reverse().join("")?-1:1:void 0})},orderCodeASC:function(){this.excelData.sort(function(e,t){return e.hasOwnProperty("code")?e.code>t.code?1:-1:e.hasOwnProperty("SKU")?e.SKU>t.SKU?1:-1:void 0})},uploadFromServer:function(){var e=this;this.download_excel_loading=!0;var t=n()(this.excelData);t=(t=t||"").replace(/\:0,/g,':"",').replace(/\:0}/g,':""}');var a=new FormData;a.append("json",t),this.$http.post(o.a.HOST+"/order/excel/production",a,{responseType:"arraybuffer",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){var r=new Blob([a.data],{type:""}),s=e.operation_order.date,i="order_with_barcode"+s+".xlsx";t.indexOf("code")>-1&&t.indexOf("total")&&(i="production_file"+s+".xlsx"),_()(new Blob([r],{type:"application/octet-stream"}),i),e.download_excel_loading=!1}).catch(function(t){e.download_excel_loading=!1})},wcUp:function(e){var t=this,a=e.id,r=this.$store.state.user.key;l.a.cRequest(this,"/order/wc/up",{id:a,key:r},function(e){switch(e.service_code){case o.a.WC_UP:e.result.affectedRows?t.requestOrdersData():l.a.showTip(t,"warning","SOME ERROR IN YOUR EXCEL!");break;default:l.a.showTip(t,"warning","UNKNOW ERROR!")}})},wcUpResult:function(e){var t=this;this.show_result_row=e;var a=e.id,r=this.$store.state.user.key;l.a.cRequest(this,"/order/wc/up/result",{id:a,key:r},function(e){switch(e.service_code){case o.a.WC_UP_RESULT:t.showUpResult(e.result);break;default:l.a.showTip(t,"warning","UNKNOW ERROR!")}})},showUpResult:function(e){for(var t in this.up_result_data=e,this.up_result_data)if(this.up_result_data.hasOwnProperty(t)){var a=this.up_result_data[t];a.re=JSON.parse(a.re),a.cnmessage=a.re.cnmessage,a._result=a.re.success}this.dialog_for_up_result=!0},filterUpResult:function(e,t){return t._result===e},filterIsSending:function(e,t){return e?t._print>0:t._print<1},upWcOnce:function(e){var t=this;this.dialog_for_up_result_up_once=!0;var a=e.id,r=this.$store.state.user.key;l.a.cRequest(this,"/order/get/item",{id:a,key:r},function(e){switch(e.service_code){case o.a.WC_UP_SINGLE_GET_ORDER_ITEM:t.single_up_wc=e.result[0];break;default:l.a.showTip(t,"warning","UNKNOW ERROR!")}})},upSingleWc:function(){var e=this;this.single_up_wc.id;var t="";try{t=n()(this.single_up_wc)}catch(e){return void l.a.showTip(this,"warning","BEFORE ERQUEST ERROR!")}var a=this.$store.state.user.key;l.a.cRequest(this,"/order/wc/up/single",{single:t,key:a},function(t){switch(t.service_code){case o.a.WC_UP_SINGLE:e.dialog_for_up_result_up_once=!1,e.wcUpResult(e.show_result_row),l.a.showTip(e,"success","预报提交成功，请等待数据刷新，查看预报结果!");break;default:l.a.showTip(e,"warning","UNKNOW ERROR!")}})},updateOrderNo:function(e){var t=this;this.$prompt("NO."+e.no,"单号修改",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[0-9a-z\-_\.]*$/i,inputErrorMessage:"单号格式不正确"}).then(function(a){var r=a.value;t._updateOrderNo(e,r)}).catch(function(){t.$message({type:"info",message:"取消输入"})})},_updateOrderNo:function(e,t){var a=this,r=e.id,s=t,i=this.$store.state.user.key;l.a.cRequest(this,"/order/item/no/update",{id:r,no:s,key:i},function(e){switch(e.service_code){case o.a.UPDATE_NO:e.result?0==e.result.length?l.a.showTip(a,"warning","修改失败，请确认被修改的订单没有发货或在配货。同时确认输入单号不存在!"):1==e.result[0].affectedRows&&(l.a.showTip(a,"success","修改成功!"),a.wcUpResult(a.show_result_row)):l.a.showTip(a,"warning","UNKNOW ERROR!");break;default:l.a.showTip(a,"warning","UNKNOW ERROR!")}})},updateOrderContent:function(e){var t=this;this.$prompt(""+e.content,"需求修改",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^\[\{\"[\{\[\}\]\"\,\:0-9a-z\-_\.]*\"\}\]$/i,inputErrorMessage:"单号格式不正确"}).then(function(a){var r=a.value;t._updateOrderContent(e,r)}).catch(function(){t.$message({type:"info",message:"取消输入"})})},_updateOrderContent:function(e,t){var a=this,r=t,s={};try{s=JSON.parse(r)}catch(e){return void l.a.showTip(this,"warning","输入错误，请注意格式!")}for(var i in s)if(s.hasOwnProperty(i)){var n=s[i];for(var c in n){if("Quantity"!==c&&"SKU"!==c)return void l.a.showTip(this,"warning","输入错误，请注意格式!");var u=n[c];if("Quantity"!=c&&"SKU"!=c)return void l.a.showTip(this,"warning","输入错误，请注意格式!");if("Quantity"==c)try{if(!parseInt(u)||parseInt(u)<1)return void l.a.showTip(this,"warning","输入错误，请注意格式!")}catch(e){return void l.a.showTip(this,"warning","输入错误，请注意格式!")}}}var p=e.id,d=this.$store.state.user.key;l.a.cRequest(this,"/order/item/content/update",{id:p,content:r,key:d},function(e){switch(e.service_code){case o.a.UPDATE_CONTENT:e.result?0==e.result.length?l.a.showTip(a,"warning","输入错误，请注意格式!"):1==e.result[0].affectedRows?(l.a.showTip(a,"success","修改成功!"),a.wcUpResult(a.show_result_row)):0==e.result[0].affectedRows&&l.a.showTip(a,"warning","修改失败，订单已经生产!"):l.a.showTip(a,"warning","UNKNOW ERROR!");break;default:l.a.showTip(a,"warning","UNKNOW ERROR!")}})},_updateDidPrintTag:function(e){var t=this,a=e.id,r=this.$store.state.user.key;l.a.cRequest(this,"/order/item/print/did",{id:a,key:r},function(e){switch(e.service_code){case o.a.PRINT_DID:e.result?0==e.result.length?l.a.showTip(t,"warning","UNKNOW ERROR!"):0==e.result[0].affectedRows?(l.a.showTip(t,"warning","发货确认失败！请检查播种筐内该订单情况!"),t.wcUpResult(t.show_result_row)):1==e.result[0].affectedRows&&(l.a.showTip(t,"success","修改成功!"),t.wcUpResult(t.show_result_row)):l.a.showTip(t,"warning","UNKNOW ERROR!");break;default:l.a.showTip(t,"warning","UNKNOW ERROR!")}})},updateDidPrintTag:function(e){var t=this;this.$confirm("请确认是否已发货?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t._updateDidPrintTag(e)}).catch(function(){t.$message({type:"info",message:"已取消修改"})})},updateDidNotPrintTag:function(e){var t=this;this.$confirm("请确认改为未发货状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t._updateDidNotPrintTag(e)}).catch(function(){t.$message({type:"info",message:"已取消修改"})})},_updateDidNotPrintTag:function(e){var t=this,a=e.id,r=this.$store.state.user.key;l.a.cRequest(this,"/order/item/print/didnot",{id:a,key:r},function(e){switch(e.service_code){case o.a.PRINT_DID_NOT:e&&e.result&&e.result[0]&&1==e.result[0].affectedRows?(l.a.showTip(t,"success","修改成功!"),t.wcUpResult(t.show_result_row)):l.a.showTip(t,"warning","修改失败!");break;default:l.a.showTip(t,"warning","UNKNOW ERROR!")}})},deleteItemOrder:function(e){var t=this;this.$confirm('请确认是否删除时间为"'+e.date+'",描述为:"'+e._describe+'"的订单?',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t._deleteItemOrder(e),t.$message({type:"info",message:"删除描述为"+e._describe+"的订单"})}).catch(function(){t.$message({type:"info",message:"已取消"})})},_deleteItemOrder:function(e){var t=this,a=e.id,r=e._describe,s=e.date,i=this.operation_customer.id,n=this.$store.state.user.key;l.a.cRequest(this,"/order/delete",{id:a,key:n,_describe:r,date:s,customer:i},function(e){switch(e.service_code){case o.a.ORDER_DELETE:e&&e.result&&e.result[0]&&1==e.result[0].affectedRows?(l.a.showTip(t,"success","删除成功!"),t.requestOrdersData()):l.a.showTip(t,"warning","删除失败，请检查播种筐以及是否有商品已发货!");break;default:l.a.showTip(t,"warning","UNKNOW ERROR!")}})}},mounted:function(){this.requestData()},watch:{operation_customer:function(){this.edit_rule=!1}}}),f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-mag"},[a("el-card",{attrs:{shadow:"hover"}},[a("el-select",{staticClass:"user-select",attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入客户邮箱地址","remote-method":e.selectRemoteMethod,loading:e.user_select.loading},model:{value:e.user_select.value,callback:function(t){e.$set(e.user_select,"value",t)},expression:"user_select.value"}},e._l(e.user_select.select,function(e){return a("el-option",{key:e.account,attrs:{label:e.name+":"+e.account,value:e.id}})})),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.user_select.value,expression:"user_select.value"}],on:{click:e.bindingCustomer}},[e._v("绑定客户")])],1),e._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.operation_customer.name&&e.edit_rule,expression:"operation_customer.name&&edit_rule"}],attrs:{shadow:"hover"}},[a("el-input",{attrs:{type:"textarea",autosize:"",resize:"none",placeholder:"REGEXP"},model:{value:e.regexp_ipt,callback:function(t){e.regexp_ipt=t},expression:"regexp_ipt"}}),e._v(" "),a("div",{staticStyle:{margin:"20px 0"}}),e._v(" "),a("el-input",{attrs:{type:"textarea",resize:"none",autosize:"",placeholder:"ARRAY"},model:{value:e.array_ipt,callback:function(t){e.array_ipt=t},expression:"array_ipt"}}),e._v(" "),a("el-button",{staticClass:"sure-btn",on:{click:e.updateRule}},[e._v("SURE")])],1),e._v(" "),a("el-row",{staticClass:"content",attrs:{gutter:20}},[a("el-col",{staticClass:"bind-list",attrs:{xs:24,sm:24,md:12}},[a("el-card",{attrs:{shadow:"hover"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.customer_data}},[a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"account",label:"邮箱"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.showUpload(t.$index)}}},[e._v("操作")])]}}])})],1)],1)],1),e._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.operation_customer.name,expression:"operation_customer.name"}],attrs:{xs:24,sm:24,md:12}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.upload_loading,expression:"upload_loading"}],attrs:{shadow:"hover"}},[a("div",[a("span",{staticStyle:{"font-size":"20px"}},[e._v(e._s("(当前:"+e.operation_customer.name+")"))]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:e.showRule}},[e._v("EDIT RULE")])],1),e._v(" "),a("el-alert",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"},attrs:{title:"TIP: 选择一个总文件夹，然后点击Upload按钮，文件总大小不要超过1G。",type:"info"}}),e._v(" "),a("label",{staticClass:"lb-for-img",attrs:{for:"file"}},[a("input",{staticClass:"ipt-img-select",attrs:{type:"file",name:"file",id:"file",webkitdirectory:""},on:{change:function(t){e.changeFile(t)}}}),e._v(" "),a("div",{staticStyle:{cusor:"pointer","font-size":"20px",color:"#999"}},[e._v(e._s(e.Files.length?"已选择:"+e.Files.length:e.label_for_img_select))])]),e._v(" "),a("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.img_progress_show,expression:"img_progress_show"}],attrs:{percentage:e.img_progress}}),e._v(" "),a("el-button",{staticClass:"upload-btn",attrs:{type:"primary"},on:{click:e.uploadFiles}},[e._v("Upload")]),e._v(" "),a("div",[a("el-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{title:"TIP: EXCEL 导入第一行必须含有'SKU'、'Quantity'注意大小写，同时生产表只有在SKU末尾是尺码的情况下有用。",type:"info"}}),e._v(" "),a("el-input",{staticClass:"price-ipt",attrs:{placeholder:"总价（选填）"},on:{change:e.priceChange},model:{value:e.excel_param.price,callback:function(t){e.$set(e.excel_param,"price",t)},expression:"excel_param.price"}}),e._v(" "),a("el-input",{staticClass:"describe-ipt",attrs:{type:"textarea",resize:"none",autosize:"",placeholder:"描述（选填）"},model:{value:e.excel_param._describe,callback:function(t){e.$set(e.excel_param,"_describe",t)},expression:"excel_param._describe"}}),e._v(" "),a("el-date-picker",{staticClass:"describe-ipt",attrs:{type:"date","value-format":"yyyy-MM-dd",format:"yyyy 年 MM 月 dd 日",placeholder:"选择日期 (必须)"},model:{value:e.excel_param.date,callback:function(t){e.$set(e.excel_param,"date",t)},expression:"excel_param.date"}}),e._v(" "),a("el-upload",{staticClass:"upload-excel",attrs:{disabled:!e.excel_param.date,action:e.HOST+"/order/upload/excel",data:{id:e.excel_param.id,key:e.excel_param.key,price:e.Rsa(e.excel_param.price),_describe:e.Rsa(e.excel_param._describe),date:e.Rsa(e.excel_param.date)},name:e.FileDefaultName,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"before-upload":e.beforeUpload,limit:1,"on-exceed":e.handleExceed,"on-success":e.onUploadSuccess,"on-change":e.importExcel,"with-credentials":!0,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"}},[a("el-button",{attrs:{type:"primary",disabled:!e.excel_param.date}},[e._v("点击上传 Excel")]),e._v(" "),a("el-alert",{staticStyle:{"font-size":"10px","margin-top":"10px"},attrs:{slot:"tip",title:"只能上传excel文件，且不超过500kb",type:"info"},slot:"tip"})],1)],1)],1)],1)],1),e._v(" "),e.operation_customer.name?a("el-card",{attrs:{shadow:"hover"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.Orders.loading&&e.upload_loading,expression:"Orders.loading&&upload_loading"}],staticStyle:{width:"100%"},attrs:{data:e.Orders.data,"default-sort":{prop:"time",order:"descending"}},on:{"sort-change":e.sortChange}},[a("el-table-column",{attrs:{sortable:"custom",fixed:"",prop:"date",label:"时间",width:"240"}}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:"总金额",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"_describe",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",prop:"state",label:"状态",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.state+""=="0"?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.wcUp(t.row)}}},[e._v("模拟申报")]):a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.wcUpResult(t.row)}}},[e._v("申报结果")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.checkOrderDetial(t.$index)}}},[e._v("发货表")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.createProduction(t.$index)}}},[e._v("生产表")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.deleteItemOrder(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pagination",attrs:{"page-size":e.Orders.page_size,"page-sizes":[5,10,20,50,100],total:e.Orders.total,layout:"prev, pager, next, total, slot ,sizes"},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1):e._e(),e._v(" "),e.operation_customer.name?a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{staticClass:"button",on:{click:e.downloadFile}},[e._v("导出(无图)")]),e._v(" "),a("el-button",{staticClass:"button",on:{click:e.orderCode}},[e._v("重新排序(字母倒排)")]),e._v(" "),a("el-button",{staticClass:"button",on:{click:e.orderCodeASC}},[e._v("排序(字母顺排)")]),e._v(" "),e.create_barcode_show?a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.create_barcode_loading,expression:"create_barcode_loading"}],attrs:{disabled:e.create_barcode_loading},on:{click:e.createBarCode}},[e._v("生成码")]):e._e(),e._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.download_excel_loading,expression:"download_excel_loading"}],staticClass:"button",attrs:{disabled:e.download_excel_loading},on:{click:e.uploadFromServer}},[e._v("下载(有图)")]),e._v(" "),a("el-table",{staticStyle:{"margin-top":"20px"},attrs:{id:"print",data:e.excelData,"tooltip-effect":"dark",border:""}},[e.excelData.length>0?a("el-table-column",{key:"Image",attrs:{label:"Image",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.SKU||t.row.code?a("img",{staticClass:"col-img",attrs:{src:t.row.Image},on:{"~error":function(a){e.imgError(a,t.$index)}}}):e._e()]}}])}):e._e(),e._v(" "),e._l(e.excelTitle,function(t){return["Image"!=t?a("el-table-column",{key:t,staticClass:"col-info",attrs:{width:e.isProduction?"code"==t||"Address"==t?160:e.order_table_width:140,label:t,prop:t}}):e._e()]})],2)],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"申报结果",visible:e.dialog_for_up_result},on:{"update:visible":function(t){e.dialog_for_up_result=t}}},[a("span",[e._v("订单总数:"+e._s(e.up_result_data.length))]),e._v(" "),a("el-button",{staticClass:"button",staticStyle:{float:"right","margin-right":"20px"},on:{click:e.downloadNoSendingFile}},[e._v("导出(缺货表)")]),e._v(" "),a("el-button",{staticClass:"button",staticStyle:{float:"right","margin-right":"20px"},on:{click:e.downloadSendingFile}},[e._v("导出(发货表)")]),e._v(" "),a("el-table",{attrs:{data:e.up_result_data}},[a("el-table-column",{attrs:{property:"no",label:"包裹号(no)",fixed:"left"}}),e._v(" "),a("el-table-column",{attrs:{property:"label",label:"播种框编号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{property:"quantity",label:"数量",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[!t.row.label&&t.row._print<1?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.updateOrderNo(t.row)}}},[e._v("单号修改")]):e._e(),e._v(" "),!t.row.label&&t.row._print<1?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.updateOrderContent(t.row)}}},[e._v("需求修改")]):e._e(),e._v(" "),t.row.label||0!=t.row._print?e._e():a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.updateDidPrintTag(t.row)}}},[e._v("标记已发货")]),e._v(" "),t.row._print>0?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),e.updateDidNotPrintTag(t.row)}}},[e._v("标记未发货")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"_result",label:"申报(成功)",width:"90",filters:[{text:"成功",value:1},{text:"失败",value:0}],"filter-method":e.filterUpResult,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"bottom"}},[a("p",[e._v(e._s(t.row.cnmessage))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{type:0===t.row._result?"primary":"success","disable-transitions":""}},[e._v(e._s(0===t.row._result?"失败":"成功"))])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"_print",label:"状态",width:"80",filters:[{text:"已发",value:1},{text:"未发",value:0}],"filter-method":e.filterIsSending,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row._print>0?"success":"primary","disable-transitions":""}},[e._v(e._s(t.row._print>0?"已发":"未发"))])]}}])})],1),e._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.dialog_for_up_result_up_once&&e.dialog_for_up_result,expression:"dialog_for_up_result_up_once&&dialog_for_up_result"}],staticClass:"single_up_wc"},[a("i",{staticClass:"el-icon el-icon-close",staticStyle:{position:"absolute",top:"10px",right:"10px","font-size":"20px",color:"#999",cursor:"pointer"},on:{click:function(t){e.dialog_for_up_result_up_once=!1}}}),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("no")]),e._v(" "),a("el-input",{attrs:{placeholder:"no"},model:{value:e.single_up_wc.no,callback:function(t){e.$set(e.single_up_wc,"no",t)},expression:"single_up_wc.no"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("method")]),e._v(" "),a("el-input",{attrs:{placeholder:"method"},model:{value:e.single_up_wc.method,callback:function(t){e.$set(e.single_up_wc,"method",t)},expression:"single_up_wc.method"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("weight")]),e._v(" "),a("el-input",{attrs:{placeholder:"weight"},model:{value:e.single_up_wc.weight,callback:function(t){e.$set(e.single_up_wc,"weight",t)},expression:"single_up_wc.weight"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("countrycode")]),e._v(" "),a("el-input",{attrs:{placeholder:"countrycode"},model:{value:e.single_up_wc.countrycode,callback:function(t){e.$set(e.single_up_wc,"countrycode",t)},expression:"single_up_wc.countrycode"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("province")]),e._v(" "),a("el-input",{attrs:{placeholder:"province"},model:{value:e.single_up_wc.province,callback:function(t){e.$set(e.single_up_wc,"province",t)},expression:"single_up_wc.province"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("city")]),e._v(" "),a("el-input",{attrs:{placeholder:"city"},model:{value:e.single_up_wc.city,callback:function(t){e.$set(e.single_up_wc,"city",t)},expression:"single_up_wc.city"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("name")]),e._v(" "),a("el-input",{attrs:{placeholder:"name"},model:{value:e.single_up_wc.name,callback:function(t){e.$set(e.single_up_wc,"name",t)},expression:"single_up_wc.name"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("postcode")]),e._v(" "),a("el-input",{attrs:{placeholder:"postcode"},model:{value:e.single_up_wc.postcode,callback:function(t){e.$set(e.single_up_wc,"postcode",t)},expression:"single_up_wc.postcode"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap",staticStyle:{width:"520px"}},[a("p",[e._v("street")]),e._v(" "),a("el-input",{staticStyle:{width:"520px"},attrs:{placeholder:"street"},model:{value:e.single_up_wc.street,callback:function(t){e.$set(e.single_up_wc,"street",t)},expression:"single_up_wc.street"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("telephone")]),e._v(" "),a("el-input",{attrs:{placeholder:"telephone"},model:{value:e.single_up_wc.telephone,callback:function(t){e.$set(e.single_up_wc,"telephone",t)},expression:"single_up_wc.telephone"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("enname")]),e._v(" "),a("el-input",{attrs:{placeholder:"enname"},model:{value:e.single_up_wc.enname,callback:function(t){e.$set(e.single_up_wc,"enname",t)},expression:"single_up_wc.enname"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap",staticStyle:{width:"520px"}},[a("p",[e._v("cnname")]),e._v(" "),a("el-input",{staticStyle:{width:"520px"},attrs:{placeholder:"cnname"},model:{value:e.single_up_wc.cnname,callback:function(t){e.$set(e.single_up_wc,"cnname",t)},expression:"single_up_wc.cnname"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("p",[e._v("content")]),e._v(" "),a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"content",disabled:""},model:{value:e.single_up_wc.content,callback:function(t){e.$set(e.single_up_wc,"content",t)},expression:"single_up_wc.content"}})],1),e._v(" "),a("div",{staticClass:"single_up_wc_inner_item_wrap"},[a("el-button",{staticStyle:{float:"right","margin-top":"20px"},on:{click:e.upSingleWc}},[e._v("提交预报")])],1)])],1)],1)},staticRenderFns:[]};var v=a("VU/8")(h,f,!1,function(e){a("JyVJ"),a("16es")},"data-v-7cc72971",null);t.default=v.exports}});