webpackJsonp([6],{C7NV:function(t,e){},"Xtw/":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("GxbW"),a=s("0881"),i=s("2CU/"),o=s("TVmP"),l=s("DmT9"),u=s.n(l),r=s("2736"),c=(i.a.encryptRsa,i.a.decryptRsa,i.a.pwdEncrypt,{name:"login",data:function(){return{CONST:a.a,mag_name:"热转印扫码系统",login_tip:"THERMAL TRANSFER PRINT SYSTEM",sku:{placeholder:"SKU",value:""},loading:!1,number:0,can_enter:!0,new_20th:[],last_sku:"",LODOP:void 0}},components:{"footer-c":o.a},methods:{getLabel:function(){var t=this;if(this.LODOP){if(!this.loading&&this.can_enter&&this.sku.value){this.can_enter=!1,this.loading=!0;var e=this.sku.value,s=this.$store.state.user.key;e=e.replace(/\s/g,""),n.a.cRequest(this,"/process/new",{key:s,sku:e},function(e){t.can_enter=!0,t.loading=!1,e&&e.result&&e.result[0]?(t.number++,n.a.showTip(t,"success","记录成功！"),t.printLabel(),t.last_sku=t.sku.value,t.sku.value="",t.$notify({title:"成功录入!",message:"<"+e.result[0].time.replace(/\s/g,"").replace(/^([0-9\-]{10})/,"$1.")+">"+e.result[0].sku+"--\x3e"+e.result[0].no})):(n.a.showTip(t,"warning","记录失败，该SKU不处于可录入订单内！"),t.sku.value="")})}}else n.a.showTip(this,"info","请稍等，打印控件没有加载成功。")},back1To0:function(){var t=this,e=this.$store.state.user.key,s=this.last_sku;n.a.cRequest(this,"/process/back/1/0",{key:e,sku:s},function(e){e&&e.result&&e.result[0]&&e.result[0].changedRows>0?(n.a.showTip(t,"success","撤销成功！"),t.last_sku=""):n.a.showTip(t,"warning","撤销失败！")})},printLabel:function(){if(this.LODOP)if(this.sku.value){var t=this.sku.value+(new Date).getTime();console.log("质检打印任务："+t),this.LODOP.PRINT_INIT("质检打印任务："+t),this.LODOP.ADD_PRINT_TEXT("30mm","1cm","40mm","3mm",this.sku.value),this.LODOP.ADD_PRINT_BARCODE("1mm","10mm","32mm","32mm","QRCode",this.sku.value),this.LODOP.PRINT()}else n.a.showTip(this,"warning","SKU为空！")}},mounted:function(){var t=this,e=u()(a.a.ip,{path:"/transfer"});e.on("connect",function(t){console.log("connect io")}),e.on("flesh",function(e){var s=JSON.parse(i.a.decryptRsa(e));t.new_20th=s.reverse()}),this.LODOP=r.a.getLodop()}}),p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login-wrap label-print",on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.getLabel(e)}}},[s("el-card",{staticClass:"form-wrap"},[s("h1",{staticClass:"mag-name"},[t._v(t._s(t.mag_name))]),t._v(" "),s("p",{staticClass:"login-tip"},[t._v(t._s(t.login_tip))]),t._v(" "),s("el-input",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"ipt",attrs:{placeholder:t.sku.placeholder,type:"text"},on:{blur:function(t){t.target.focus()}},model:{value:t.sku.value,callback:function(e){t.$set(t.sku,"value",e)},expression:"sku.value"}}),t._v(" "),s("el-button",{on:{click:function(e){t.number=0}}},[t._v(t._s(t.number)+"（点击计数清零）")]),t._v(" "),t.last_sku?s("el-button",{on:{click:t.back1To0}},[t._v("返回上一次")]):t._e(),t._v(" "),s("p",[t.LODOP?t._e():s("a",{attrs:{href:t.CONST.ip+"/uploads/other/CLodop_Setup_for_Win32NT.exe"}},[t._v("下载控件(安装后重启浏览器)")]),t._v(t._s(t.LODOP?"打印控件加载成功。":"打印控件正在加载，请稍等。")),s("el-button",{attrs:{type:"text",disabled:!t.LODOP},on:{click:t.printLabel}},[t._v("直接打印")])],1)],1),t._v(" "),t.new_20th.length>0?s("el-card",{staticClass:"info",staticStyle:{width:"auto",position:"fixed",bottom:"20px",left:"20px","font-size":"12px","z-index":"-1"}},t._l(t.new_20th,function(e,n){return s("p",{key:n,staticStyle:{"margin-bottom":"10px"}},[t._v("\n      <"+t._s(e.time)+">"+t._s(e.sku)+" ====> "+t._s(e.no)+"\n    ")])})):t._e(),t._v(" "),s("footer-c",{staticClass:"footer",staticStyle:{position:"absolute",bottom:"0"}})],1)},staticRenderFns:[]};var _=s("VU/8")(c,p,!1,function(t){s("C7NV"),s("n98S")},"data-v-78198262",null);e.default=_.exports},n98S:function(t,e){}});