webpackJsonp([9],{ORTn:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("mvHQ"),l=r.n(a),o=r("0881"),s=r("GxbW"),i=(r("2CU/"),r("uXZL")),n=r.n(i),c=r("t4zo"),d=r.n(c),_=(r("PJh5"),{name:"FactoryOrders",data:function(){return{fileList:[],order_list_size:5,order_list_total:0,order_list_current:1,order_list_loading:!1,order_list:[],order_check:[],order_check_total:0,order_check_loading:!1,check_type:""}},methods:{xlxsChange:function(t,e){t.url;console.log(t);var r=new FileReader,a=this;r.onload=function(e){var r=e.target.result;a.rABS?a.wb=n.a.read(btoa(this.fixdata(r)),{type:"base64"}):a.wb=n.a.read(r,{type:"binary"});var l=n.a.utils.sheet_to_json(a.wb.Sheets[a.wb.SheetNames[0]]);a.submitExcel(t.name.replace(/\.xlsx$/,""),l)},this.rABS?r.readAsArrayBuffer(t.raw):r.readAsBinaryString(t.raw)},fixdata:function(t){for(var e="",r=0,a=10240;r<t.byteLength/a;++r)e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(r*a,r*a+a)));return e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(r*a)))},submitExcel:function(t,e){var r=this,a=this.$store.state.user.key,o=l()(e);s.a.cRequest(this,"/factory/order/in",{key:a,name:t,json:o},function(t){t&&t.result&&t.result.affectedRows>0?r.getOrderList():s.a.showTip(r,"warning","导入失败！请检查表格！")})},getOrderList:function(){var t=this;this.order_list_loading=!0;var e=this.$store.state.user.key,r=this.order_list_current,a=this.order_list_size;s.a.cRequest(this,"/factory/order/list",{current_page:r,page_size:a,key:e},function(e){e&&e.result&&e.result.length>0&&(t.order_list=e.result,t.order_list_total=e.result[0].total),t.order_list_loading=!1})},orderListSizeChange:function(t){this.order_list_size=t,this.getOrderList()},orderListCurrentChange:function(t){this.order_list_current=t,this.getOrderList()},check:function(t){var e=this,r=t.row.id,a=this.$store.state.user.key;this.order_check_loading=!0,s.a.cRequest(this,"/factory/order/check",{id:r,key:a},function(t){t&&t.result&&t.result.length>0?(e.order_check=t.result,e.order_check_total=e.order_check.length,e.check_type="全部"):(e.order_check=[],e.order_check_total=0,e.check_type=""),e.order_check_loading=!1})},notSent:function(t){var e=this,r=t.row.id,a=this.$store.state.user.key;this.order_check_loading=!0,s.a.cRequest(this,"/factory/order/notsent",{id:r,key:a},function(t){t&&t.result&&t.result.length>0?(e.order_check=t.result,e.order_check_total=e.order_check.length,e.check_type="未发"):(e.order_check=[],e.order_check_total=0,e.check_type=""),e.order_check_loading=!1})},downloadMb:function(){d()(o.a.ip+"/uploads/工厂导单模版.xlsx","工厂导单模版.xlsx")}},mounted:function(){this.getOrderList()},watch:{},computed:{order_check_format:function(){var t=[],e=[];for(var r in this.order_check)if(this.order_check.hasOwnProperty(r)){var a=this.order_check[r],l=a.code,o=a.size;e.indexOf(l)<0&&(e.push(l),t.push({code:l}));var s=e.indexOf(l);t[s][o]=t[s][o]?t[s][o]+1:1}return t}}}),u={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"factory-orders",staticStyle:{"padding-top":"10px"}},[r("el-row",{staticClass:"content",attrs:{gutter:20}},[r("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:24,md:12}},[r("el-card",{attrs:{shadow:"hover"}},[r("h1",{staticStyle:{"font-size":"24px","margin-bottom":"10px"}},[t._v("导入工厂订单")]),t._v(" "),r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"https://127.0.0.1/posts/","file-list":t.fileList,"auto-upload":!1,accept:".xlsx","on-change":t.xlxsChange}},[r("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取EXCEL文件")]),t._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传.xlxs文件")])],1),t._v(" "),r("el-button",{attrs:{type:"text"},on:{click:t.downloadMb}},[t._v("下载模版")])],1)],1),t._v(" "),r("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:24,md:12}},[r("el-card",{attrs:{shadow:"hover"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.order_list_loading,expression:"order_list_loading"}],staticStyle:{width:"100%"},attrs:{data:t.order_list}},[r("el-table-column",{attrs:{fixed:"",prop:"time",label:"时间",width:"180"}}),t._v(" "),r("el-table-column",{attrs:{fixed:"",prop:"name",label:"订单名"}}),t._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"查看",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(r){r.preventDefault(),t.check(e)}}},[t._v("全部")]),t._v(" "),r("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(r){r.preventDefault(),t.notSent(e)}}},[t._v("未发货")])]}}])})],1),t._v(" "),r("el-pagination",{staticClass:"pagination",attrs:{"page-size":t.order_list_size,"page-sizes":[5,10,20,50,100],total:t.order_list_total,layout:"prev, pager, next, total, slot ,sizes"},on:{"size-change":t.orderListSizeChange,"current-change":t.orderListCurrentChange}})],1)],1),t._v(" "),r("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:24,md:24,xl:24}},[r("el-card",{attrs:{shadow:"hover"}},[r("span",[t._v(t._s(t.check_type)+"总数:"+t._s(t.order_check_total))]),t._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.order_check_loading,expression:"order_check_loading"}],staticStyle:{width:"100%"},attrs:{data:t.order_check_format}},[r("el-table-column",{attrs:{prop:"code",label:"编号",width:"180"}}),t._v(" "),r("el-table-column",{attrs:{prop:"XS",label:"XS"}}),t._v(" "),r("el-table-column",{attrs:{prop:"S",label:"S"}}),t._v(" "),r("el-table-column",{attrs:{prop:"M",label:"M"}}),t._v(" "),r("el-table-column",{attrs:{prop:"L",label:"L"}}),t._v(" "),r("el-table-column",{attrs:{prop:"XL",label:"XL"}}),t._v(" "),r("el-table-column",{attrs:{prop:"2XL",label:"2XL"}}),t._v(" "),r("el-table-column",{attrs:{prop:"3XL",label:"3XL"}}),t._v(" "),r("el-table-column",{attrs:{prop:"4XL",label:"4XL"}}),t._v(" "),r("el-table-column",{attrs:{prop:"5XL",label:"5XL"}}),t._v(" "),r("el-table-column",{attrs:{prop:"6XL",label:"6XL"}}),t._v(" "),r("el-table-column",{attrs:{prop:"ADULT",label:"ADULT"}}),t._v(" "),r("el-table-column",{attrs:{prop:"YOUTH",label:"YOUTH"}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var h=r("VU/8")(_,u,!1,function(t){r("pcU1"),r("Tdnx")},"data-v-1bd456bf",null);e.default=h.exports},Tdnx:function(t,e){},pcU1:function(t,e){}});